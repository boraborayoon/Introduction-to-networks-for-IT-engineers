## 11.2 LACP
- 90년대 중반까지는 각 벤더별로 장비 간 대역폭을 늘리기 위해 독자적인 방법을 구현했지만, 97년 11월 IEEE 802.3 그룹이 상호호환 가능한 연결 계층(Link Layer) 표준화를 시작
- 이 표준화가 바로 LACP이다.
- LACP = Link Aggregation Control Protocol
- LACP는 액티브-액티브 구조이므로 LACP로 구성하는 논리 인터페이스의 대역폭을 서비스에 필요한 전체 트래픽 기준으로 서비스 트래픽을 산정하면 안된다. 또한 LACP로 구성하는 물리 인터페이스들의 속도가 동일해야한다.

### 11.2.1 LACP 동작 방식
- LACP를 통해 장비 간 논리 인터페이스를 구성하기 위해 LACPDU(LACP Data Unit)라는 프레임을 사용한다.
- LACPDU에는 LACP를 구성하기 위한 출발지 주소, 목적지 주소, 타입, 서브 타입, 버전 정보 등을 포함해 매초마다 주고받는다.
- LACPDU는 멀티캐스트를 이용한다.
- LACP가 연결되려면 LACPDU를 주고받는 장비가 한 장비여야한다.
- LACP 논리 인터페이스를 구성하려면 LACPDU 패킷을 주고받아야하는데, 이때 LACP설정이 있는 장비에서만 LACPDU를 상대방 장비로 보낼 수 있다.
- 두개의 모드가 있다.
  - 액티브: LACPDU를 먼저 송신하고 상대방이 LACP로 구성된 경우, LACP를 구성
  - 패시브: LACPDU를 송신하지않지만, LACPDU를 수신받으면 응답해 LACP를 구성
- 양 장비 모두 패시브로 설정하면 LACPDU를 아무도 먼저 보내지 않으므로 정상적으로 LACP 연결이 되지 않는다.
- 일반적으로 LACP로 구성될 수 있는 인터페이스 수는 1~8개이고, 장비에 따라 16개 이상을 하나의 논리 인터페이스로 묶는 기능이 지원될 수 도 있다. 그리고 LACP 논리 인터페이스를 구성하는 물리 인터페이스들은 반드시 동일한 속도의 인터페이스로 구성해야한다. 즉, 1G 두개의 인터페이스를 묶어 2G로, 10G 인터페이스 네 개를 묶어 40G로 구성할 수 있지만, 1G 한개와 10G 한개를 묶어 11G와 같은 논리 인터페이스는 만들 수 없다.

### 11.2.2 LACP와 PXE
- PXE = Pre-boot eXecution Environment
- 두 네트워크 장비간 LACPDU를 통한 협상을 통해 LACP가 동작한다. 서버와 액티브-액티브 형태로 인텉페이스 이중화를 구성할 때도 LACPDU를 사용한다. 서버의 인터페이스를 하나의 논리 포트로 묶는 bonding/teaming 기술은 서버 운영 체제에서 설정한다.
- PXE를 이용할 때는 서버가 운영체제를 설치하기 전 단계이므로 bonding과 teaming 같은 논리 인터페이스를 설정할 수 없다.
- LACP로 구성하려는 서버를 PXE로 운영체제를 설치할 때는 LACP 인터페이스가 아닌 일반 인터페이스로 구성해 운영체제를 설치하고 운영체제에서 LACP 설정을 다시 한 후 스위치 포트 설정을 다시 변경해야한다.
- 스위치에서 LACPDU를 수신하지 못했을 때, 인터페이스 한 개만 활성화해 PXE Boot를 실행한다. PXE로 운영체제를 설치하고 LACPDU를 주고받으면 LACP로 구성이 변경된다.